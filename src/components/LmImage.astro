---
import { Image } from "astro:assets";
import type ImageType from "/interfaces/image";
import type { ImageAttributes } from "/interfaces/image";

type originImageType = Partial<ImageAttributes> & {
    origin: true;
    id: number;
};

function isOriginImage(p: originImageType | ImageType): p is originImageType {
    return "origin" in p;
}

type Props = ImageType | originImageType;

let p = Astro.props;
if (!isOriginImage(p)) {
    p = { id: p.id, ...p.attributes, origin: true };
}
const image = p;

const prefix = import.meta.env.PROD
    ? `https://admin.luoming.space`
    : "http://localhost:6337";
---

<Image
    class="w-full h-full object-cover"
    src={`${prefix}${image.url}`}
    widths={[240, 540, image.width]}
    sizes={"(max-width: 360px) 240px, 540px"}
    alt={image.alternativeText}
    width={image.width}
    height={image.height}
/>
